/**
 * Pre-generated Hershey-style font glyph data
 * Points are normalized 0-1 for each letter
 * Designed for particle-based rendering
 */

import type { GlyphData } from '../types';

export const GLYPH_DATA: GlyphData = {
	A: {
		points: [
			[0.0, 0.0],
			[0.5, 1.0],
			[1.0, 0.0],
			[0.25, 0.4],
			[0.75, 0.4],
		],
		width: 1.0,
	},
	B: {
		points: [
			[0.0, 0.0],
			[0.0, 0.5],
			[0.0, 1.0],
			[0.6, 0.9],
			[0.7, 0.75],
			[0.6, 0.5],
			[0.0, 0.5],
			[0.7, 0.35],
			[0.6, 0.1],
			[0.0, 0.0],
		],
		width: 0.8,
	},
	C: {
		points: [
			[0.8, 0.2],
			[0.5, 0.0],
			[0.2, 0.2],
			[0.0, 0.5],
			[0.2, 0.8],
			[0.5, 1.0],
			[0.8, 0.8],
		],
		width: 0.8,
	},
	D: {
		points: [
			[0.0, 0.0],
			[0.0, 1.0],
			[0.4, 1.0],
			[0.7, 0.8],
			[0.8, 0.5],
			[0.7, 0.2],
			[0.4, 0.0],
			[0.0, 0.0],
		],
		width: 0.8,
	},
	E: {
		points: [
			[0.7, 0.0],
			[0.0, 0.0],
			[0.0, 0.5],
			[0.5, 0.5],
			[0.0, 0.5],
			[0.0, 1.0],
			[0.7, 1.0],
		],
		width: 0.7,
	},
	F: {
		points: [
			[0.0, 0.0],
			[0.0, 0.5],
			[0.5, 0.5],
			[0.0, 0.5],
			[0.0, 1.0],
			[0.7, 1.0],
		],
		width: 0.7,
	},
	G: {
		points: [
			[0.8, 0.8],
			[0.5, 1.0],
			[0.2, 0.8],
			[0.0, 0.5],
			[0.2, 0.2],
			[0.5, 0.0],
			[0.8, 0.2],
			[0.8, 0.5],
			[0.5, 0.5],
		],
		width: 0.9,
	},
	H: {
		points: [
			[0.0, 0.0],
			[0.0, 1.0],
			[0.0, 0.5],
			[0.7, 0.5],
			[0.7, 0.0],
			[0.7, 1.0],
		],
		width: 0.7,
	},
	I: {
		points: [
			[0.2, 0.0],
			[0.5, 0.0],
			[0.35, 0.0],
			[0.35, 1.0],
			[0.2, 1.0],
			[0.5, 1.0],
		],
		width: 0.5,
	},
	J: {
		points: [
			[0.6, 1.0],
			[0.6, 0.2],
			[0.4, 0.0],
			[0.1, 0.1],
		],
		width: 0.6,
	},
	K: {
		points: [
			[0.0, 0.0],
			[0.0, 1.0],
			[0.0, 0.5],
			[0.7, 1.0],
			[0.0, 0.5],
			[0.7, 0.0],
		],
		width: 0.7,
	},
	L: {
		points: [
			[0.0, 1.0],
			[0.0, 0.0],
			[0.6, 0.0],
		],
		width: 0.6,
	},
	M: {
		points: [
			[0.0, 0.0],
			[0.0, 1.0],
			[0.45, 0.4],
			[0.9, 1.0],
			[0.9, 0.0],
		],
		width: 0.9,
	},
	N: {
		points: [
			[0.0, 0.0],
			[0.0, 1.0],
			[0.7, 0.0],
			[0.7, 1.0],
		],
		width: 0.7,
	},
	O: {
		points: [
			[0.4, 0.0],
			[0.1, 0.2],
			[0.0, 0.5],
			[0.1, 0.8],
			[0.4, 1.0],
			[0.6, 1.0],
			[0.9, 0.8],
			[1.0, 0.5],
			[0.9, 0.2],
			[0.6, 0.0],
			[0.4, 0.0],
		],
		width: 1.0,
	},
	P: {
		points: [
			[0.0, 0.0],
			[0.0, 1.0],
			[0.5, 1.0],
			[0.7, 0.85],
			[0.7, 0.65],
			[0.5, 0.5],
			[0.0, 0.5],
		],
		width: 0.7,
	},
	Q: {
		points: [
			[0.4, 0.0],
			[0.1, 0.2],
			[0.0, 0.5],
			[0.1, 0.8],
			[0.4, 1.0],
			[0.6, 1.0],
			[0.9, 0.8],
			[1.0, 0.5],
			[0.9, 0.2],
			[0.6, 0.0],
			[0.4, 0.0],
			[0.6, 0.2],
			[0.9, -0.1],
		],
		width: 1.0,
	},
	R: {
		points: [
			[0.0, 0.0],
			[0.0, 1.0],
			[0.5, 1.0],
			[0.7, 0.85],
			[0.7, 0.65],
			[0.5, 0.5],
			[0.0, 0.5],
			[0.7, 0.0],
		],
		width: 0.7,
	},
	S: {
		points: [
			[0.7, 0.9],
			[0.5, 1.0],
			[0.2, 0.9],
			[0.0, 0.75],
			[0.2, 0.5],
			[0.5, 0.5],
			[0.8, 0.35],
			[0.7, 0.1],
			[0.4, 0.0],
			[0.1, 0.1],
		],
		width: 0.8,
	},
	T: {
		points: [
			[0.0, 1.0],
			[0.8, 1.0],
			[0.4, 1.0],
			[0.4, 0.0],
		],
		width: 0.8,
	},
	U: {
		points: [
			[0.0, 1.0],
			[0.0, 0.2],
			[0.2, 0.0],
			[0.5, 0.0],
			[0.7, 0.2],
			[0.7, 1.0],
		],
		width: 0.7,
	},
	V: {
		points: [
			[0.0, 1.0],
			[0.4, 0.0],
			[0.8, 1.0],
		],
		width: 0.8,
	},
	W: {
		points: [
			[0.0, 1.0],
			[0.2, 0.0],
			[0.5, 0.5],
			[0.8, 0.0],
			[1.0, 1.0],
		],
		width: 1.0,
	},
	X: {
		points: [
			[0.0, 0.0],
			[0.7, 1.0],
			[0.35, 0.5],
			[0.0, 1.0],
			[0.7, 0.0],
		],
		width: 0.7,
	},
	Y: {
		points: [
			[0.0, 1.0],
			[0.4, 0.5],
			[0.8, 1.0],
			[0.4, 0.5],
			[0.4, 0.0],
		],
		width: 0.8,
	},
	Z: {
		points: [
			[0.0, 1.0],
			[0.7, 1.0],
			[0.0, 0.0],
			[0.7, 0.0],
		],
		width: 0.7,
	},
	' ': {
		points: [],
		width: 0.3,
	},
	a: {
		points: [
			[0.6, 0.5],
			[0.3, 0.5],
			[0.0, 0.35],
			[0.0, 0.15],
			[0.3, 0.0],
			[0.6, 0.15],
			[0.6, 0.0],
			[0.6, 0.5],
		],
		width: 0.6,
	},
	b: {
		points: [
			[0.0, 1.0],
			[0.0, 0.0],
			[0.4, 0.0],
			[0.6, 0.15],
			[0.6, 0.35],
			[0.4, 0.5],
			[0.0, 0.5],
		],
		width: 0.6,
	},
	c: {
		points: [
			[0.5, 0.5],
			[0.2, 0.5],
			[0.0, 0.35],
			[0.0, 0.15],
			[0.2, 0.0],
			[0.5, 0.0],
		],
		width: 0.5,
	},
	d: {
		points: [
			[0.6, 1.0],
			[0.6, 0.0],
			[0.2, 0.0],
			[0.0, 0.15],
			[0.0, 0.35],
			[0.2, 0.5],
			[0.6, 0.5],
		],
		width: 0.6,
	},
	e: {
		points: [
			[0.0, 0.25],
			[0.5, 0.25],
			[0.5, 0.4],
			[0.3, 0.5],
			[0.1, 0.4],
			[0.0, 0.2],
			[0.1, 0.0],
			[0.4, 0.0],
		],
		width: 0.5,
	},
	f: {
		points: [
			[0.5, 0.9],
			[0.3, 1.0],
			[0.2, 0.9],
			[0.2, 0.0],
			[0.0, 0.5],
			[0.4, 0.5],
		],
		width: 0.5,
	},
	g: {
		points: [
			[0.6, 0.5],
			[0.2, 0.5],
			[0.0, 0.35],
			[0.0, 0.15],
			[0.2, 0.0],
			[0.6, 0.0],
			[0.6, 0.5],
			[0.6, -0.2],
			[0.4, -0.35],
			[0.1, -0.3],
		],
		width: 0.6,
	},
	h: {
		points: [
			[0.0, 1.0],
			[0.0, 0.0],
			[0.0, 0.4],
			[0.3, 0.5],
			[0.5, 0.4],
			[0.5, 0.0],
		],
		width: 0.5,
	},
	i: {
		points: [
			[0.15, 0.0],
			[0.15, 0.5],
			[0.15, 0.7],
		],
		width: 0.3,
	},
	j: {
		points: [
			[0.3, 0.7],
			[0.3, 0.5],
			[0.3, -0.1],
			[0.15, -0.25],
			[0.0, -0.15],
		],
		width: 0.35,
	},
	k: {
		points: [
			[0.0, 1.0],
			[0.0, 0.0],
			[0.0, 0.25],
			[0.4, 0.5],
			[0.0, 0.25],
			[0.4, 0.0],
		],
		width: 0.4,
	},
	l: {
		points: [
			[0.15, 1.0],
			[0.15, 0.0],
		],
		width: 0.3,
	},
	m: {
		points: [
			[0.0, 0.0],
			[0.0, 0.5],
			[0.2, 0.5],
			[0.35, 0.4],
			[0.35, 0.0],
			[0.35, 0.4],
			[0.5, 0.5],
			[0.7, 0.4],
			[0.7, 0.0],
		],
		width: 0.7,
	},
	n: {
		points: [
			[0.0, 0.0],
			[0.0, 0.5],
			[0.2, 0.5],
			[0.4, 0.4],
			[0.5, 0.0],
		],
		width: 0.5,
	},
	o: {
		points: [
			[0.25, 0.0],
			[0.1, 0.1],
			[0.0, 0.25],
			[0.1, 0.4],
			[0.25, 0.5],
			[0.35, 0.5],
			[0.5, 0.4],
			[0.6, 0.25],
			[0.5, 0.1],
			[0.35, 0.0],
			[0.25, 0.0],
		],
		width: 0.6,
	},
	p: {
		points: [
			[0.0, -0.35],
			[0.0, 0.5],
			[0.3, 0.5],
			[0.5, 0.35],
			[0.5, 0.15],
			[0.3, 0.0],
			[0.0, 0.0],
		],
		width: 0.5,
	},
	q: {
		points: [
			[0.5, -0.35],
			[0.5, 0.5],
			[0.2, 0.5],
			[0.0, 0.35],
			[0.0, 0.15],
			[0.2, 0.0],
			[0.5, 0.0],
		],
		width: 0.5,
	},
	r: {
		points: [
			[0.0, 0.0],
			[0.0, 0.5],
			[0.0, 0.35],
			[0.2, 0.5],
			[0.4, 0.45],
		],
		width: 0.4,
	},
	s: {
		points: [
			[0.4, 0.45],
			[0.2, 0.5],
			[0.05, 0.4],
			[0.2, 0.25],
			[0.35, 0.15],
			[0.35, 0.05],
			[0.2, 0.0],
			[0.0, 0.05],
		],
		width: 0.45,
	},
	t: {
		points: [
			[0.2, 1.0],
			[0.2, 0.1],
			[0.35, 0.0],
			[0.5, 0.1],
			[0.0, 0.5],
			[0.4, 0.5],
		],
		width: 0.5,
	},
	u: {
		points: [
			[0.0, 0.5],
			[0.0, 0.15],
			[0.15, 0.0],
			[0.35, 0.0],
			[0.5, 0.15],
			[0.5, 0.5],
			[0.5, 0.0],
		],
		width: 0.5,
	},
	v: {
		points: [
			[0.0, 0.5],
			[0.25, 0.0],
			[0.5, 0.5],
		],
		width: 0.5,
	},
	w: {
		points: [
			[0.0, 0.5],
			[0.15, 0.0],
			[0.35, 0.3],
			[0.55, 0.0],
			[0.7, 0.5],
		],
		width: 0.7,
	},
	x: {
		points: [
			[0.0, 0.0],
			[0.5, 0.5],
			[0.25, 0.25],
			[0.0, 0.5],
			[0.5, 0.0],
		],
		width: 0.5,
	},
	y: {
		points: [
			[0.0, 0.5],
			[0.25, 0.0],
			[0.5, 0.5],
			[0.25, 0.0],
			[0.1, -0.35],
		],
		width: 0.5,
	},
	z: {
		points: [
			[0.0, 0.5],
			[0.5, 0.5],
			[0.0, 0.0],
			[0.5, 0.0],
		],
		width: 0.5,
	},
};

/**
 * Get interpolated points along a letter's strokes
 * Returns more points for smoother particle distribution
 */
export function interpolateLetterPoints(
	letter: string,
	pointsPerSegment: number = 3,
): [number, number][] {
	const glyph = GLYPH_DATA[letter];
	if (!glyph || glyph.points.length === 0) {
		return [];
	}

	const result: [number, number][] = [];

	for (let i = 0; i < glyph.points.length; i++) {
		const p1 = glyph.points[i];
		result.push(p1);

		// Interpolate to next point if not last
		if (i < glyph.points.length - 1) {
			const p2 = glyph.points[i + 1];
			for (let t = 1; t < pointsPerSegment; t++) {
				const ratio = t / pointsPerSegment;
				result.push([
					p1[0] + (p2[0] - p1[0]) * ratio,
					p1[1] + (p2[1] - p1[1]) * ratio,
				]);
			}
		}
	}

	return result;
}

/**
 * Get the width of a word in glyph units
 */
export function getWordWidth(
	word: string,
	letterSpacing: number = 0.15,
): number {
	let width = 0;
	for (const char of word) {
		const glyph = GLYPH_DATA[char] || GLYPH_DATA[char.toUpperCase()];
		if (glyph) {
			width += glyph.width + letterSpacing;
		}
	}
	// Remove trailing spacing
	return width - letterSpacing;
}
